---
layout: project
title: Project - Automatic Forecast Tool
---

<div class="jumbotron">
    <p>My most recent project was creating a python script that would take data from an excel spreadsheet and use a time series analysis algorithm: EWMA(Estimated Weight Moving Average) 

The sheet is capable of processing aprox 3000 rows of data in 30 seconds!, prior to this, it would take one week to process the data.</p>
</div>

Sample code below:

<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">returnvalue</span>(rowNum): <span style="color: #888888">#create an array of dates vs sales</span>
df <span style="color: #333333">=</span> pd<span style="color: #333333">.</span>DataFrame([sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P12)<span style="color: #333333">.</span>value, sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P11)<span style="color: #333333">.</span>value,
    sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P10)<span style="color: #333333">.</span>value, sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P9)<span style="color: #333333">.</span>value,
    sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P8)<span style="color: #333333">.</span>value, sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P7)<span style="color: #333333">.</span>value,
    sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P6)<span style="color: #333333">.</span>value, sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P5)<span style="color: #333333">.</span>value,
    sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P4)<span style="color: #333333">.</span>value, sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P3)<span style="color: #333333">.</span>value,
    sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P2)<span style="color: #333333">.</span>value, sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P1)<span style="color: #333333">.</span>value,
    sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> P0)<span style="color: #333333">.</span>value, <span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">0</span>
], index <span style="color: #333333">=</span> dates, columns <span style="color: #333333">=</span> [<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>])<span style="color: #888888"># import last 12 months sales into an array</span>

<span style="color: #888888"># CURRENT MONTH</span>
<span style="color: #008800; font-weight: bold">if</span> df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">12</span>] <span style="color: #333333">&lt;</span> df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">1</span>]: df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">12</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">1</span>]<span style="color: #888888">#</span>
<span style="color: #008800; font-weight: bold">if</span> WIP <span style="color: #000000; font-weight: bold">is</span> less than sales last year then use last year <span style="background-color: #fff0f0">&#39;s figures instead for our estimation#</span>
MONTH <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>
df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">13</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">2</span>]<span style="color: #888888"># month + 1 = prev value at that point in time# MONTH + 2</span>
df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">14</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">3</span>]<span style="color: #888888"># month + 2 = prev value at that point in time# MONTH + 3</span>
df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">15</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">4</span>]<span style="color: #888888"># month + 3 = prev value at that point in time</span>

df[<span style="background-color: #fff0f0">&#39;EWMA&#39;</span>] <span style="color: #333333">=</span> pd<span style="color: #333333">.</span>ewma(df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>], span <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">13</span>)<span style="color: #888888"># Forecast Values using EWMA(estimated weight moving average)</span>

<span style="color: #888888">## ADJUST VALUES ACORDING TO THE EWMA</span>
df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">12</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;EWMA&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">12</span>]

df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">13</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;EWMA&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">13</span>]<span style="color: #888888"># month + 1 = value estimated by EWMA algorithm at this point in time# MONTH + 2</span>
df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">14</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;EWMA&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">14</span>]<span style="color: #888888"># month + 2 = value estimated by EWMA algorithm at this point in time# MONTH + 3</span>
df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">15</span>] <span style="color: #333333">=</span> df[<span style="background-color: #fff0f0">&#39;EWMA&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">15</span>]<span style="color: #888888"># month + 3 = value estimated by EWMA algorithm at this point in time</span>

predictednet <span style="color: #333333">=</span> sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> NetStock)<span style="color: #333333">.</span>value <span style="color: #333333">-</span> (df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">13</span>] <span style="color: #333333">+</span> df[<span style="background-color: #fff0f0">&#39;Actual Sales&#39;</span>]<span style="color: #333333">.</span>iloc[<span style="color: #0000DD; font-weight: bold">14</span>])<span style="color: #888888"># Current Net Stock - Month 1 and Month 2 demand</span>

<span style="color: #008800; font-weight: bold">if</span> debug: df<span style="color: #333333">.</span>plot(title <span style="color: #333333">=</span> sheet<span style="color: #333333">.</span>cell(row <span style="color: #333333">=</span> rowNum, column <span style="color: #333333">=</span> StockCode)<span style="color: #333333">.</span>value)

<span style="color: #888888"># find out averages / forecasts e.t.c# work out ammount to order# update sheet</span>


<span style="color: #008800; font-weight: bold">return</span> predictednet<span style="color: #888888"># how much stock would we have</span>
<span style="color: #008800; font-weight: bold">if</span> we sold this <span style="color: #000000; font-weight: bold">and</span> <span style="color: #007020">next</span> months stock(helps us estimate how much we need to replen)
</pre></div>

